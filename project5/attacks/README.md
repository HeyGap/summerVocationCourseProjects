# SM2 椭圆曲线密码学攻击演示

## 概述

本目录包含了针对 SM2 和 ECDSA 椭圆曲线数字签名算法的五种主要攻击场景的完整分析、数学推导和概念验证代码。这些攻击演示了密码学实现中可能存在的安全漏洞和风险。

## 攻击类型

### 1. 泄露或重用随机数 k 攻击
- **文档**: [`docs/k_reuse_attack.md`](docs/k_reuse_attack.md)
- **PoC**: [`poc/k_reuse_attack.py`](poc/k_reuse_attack.py)
- **原理**: 利用随机数泄露或重用来恢复私钥
- **影响**: 完全破坏密钥安全性

### 2. 跨算法重用密钥和随机数攻击
- **文档**: [`docs/cross_algorithm_reuse.md`](docs/cross_algorithm_reuse.md)
- **PoC**: [`poc/cross_algorithm_attack.py`](poc/cross_algorithm_attack.py)
- **原理**: 利用不同算法间的密钥或随机数重用
- **影响**: 降低整体系统安全性

### 3. 签名延展性 (Malleability) 攻击
- **文档**: [`docs/malleability_attack.md`](docs/malleability_attack.md)
- **PoC**: [`poc/malleability_attack.py`](poc/malleability_attack.py)
- **原理**: 修改有效签名创建另一个有效签名
- **影响**: 交易 ID 变化、重放攻击

### 4. 忽略消息校验与 DER 编码歧义攻击
- **文档**: [`docs/message_validation_der_attack.md`](docs/message_validation_der_attack.md)
- **PoC**: [`poc/message_validation_attack.py`](poc/message_validation_attack.py)
- **原理**: 利用消息验证不当和编码歧义
- **影响**: 消息伪造、身份冒充

### 5. 从签名中推导公钥攻击
- **文档**: [`docs/pubkey_recovery_attack.md`](docs/pubkey_recovery_attack.md)
- **PoC**: [`poc/pubkey_recovery_attack.py`](poc/pubkey_recovery_attack.py)
- **原理**: 从签名数学恢复公钥信息
- **影响**: 隐私泄露、身份追踪

## 快速开始

### 环境要求

```bash
# 安装依赖
pip install -r ../requirements.txt
```

### 运行攻击演示

#### 1. 统一攻击套件（推荐）
```bash
python attack_suite.py
```

#### 2. 单独运行攻击
```bash
# 随机数攻击
python poc/k_reuse_attack.py

# 跨算法攻击
python poc/cross_algorithm_attack.py

# 延展性攻击
python poc/malleability_attack.py

# 消息校验攻击
python poc/message_validation_attack.py

# 公钥恢复攻击
python poc/pubkey_recovery_attack.py
```

## 文档结构

### 推导文档格式
每个攻击的文档包含：
- **攻击原理**: 基本概念和原理说明
- **数学推导**: 完整的数学分析和公式推导
- **攻击场景**: 实际应用中的攻击案例
- **检测方法**: 识别和检测攻击的方法
- **防护措施**: 防御和缓解措施
- **复杂度分析**: 攻击成本和成功率分析

### PoC 代码结构
每个 PoC 包含：
- **攻击实现**: 核心攻击算法
- **演示场景**: 多种攻击场景的演示
- **验证机制**: 攻击成功率验证
- **分析输出**: 详细的攻击分析结果

## 主要发现

### 随机数安全
- 随机数泄露或重用可以直接导致私钥泄露
- RFC 6979 确定性签名可以有效防护
- 随机数生成器的质量至关重要

### 算法隔离
- 不同算法间的密钥重用存在安全风险
- 需要实施严格的密钥隔离策略
- 跨系统的关联攻击需要重视

### 签名唯一性
- ECDSA 签名存在数学上的延展性
- 规范化签名（低 s 值）可以解决问题
- 交易系统需要考虑签名延展性影响

### 消息完整性
- 部分消息验证可能被绕过
- 编码格式的歧义性存在安全隐患
- 需要严格的消息格式验证

### 隐私保护
- 签名可以数学上恢复公钥
- 批量分析可以进行用户追踪
- 隐私保护需要额外的技术手段

## 防护建议

### 实现层面
1. **使用成熟的密码学库**
2. **实施严格的参数验证**
3. **采用确定性签名生成**
4. **强制签名规范化**
5. **完整的消息验证**

### 系统层面
1. **密钥生命周期管理**
2. **算法隔离策略**
3. **多因素身份验证**
4. **实时安全监控**
5. **定期安全审计**

### 协议层面
1. **见证隔离技术**
2. **零知识证明**
3. **环签名技术**
4. **混币服务**
5. **隐私保护协议**

## 学术价值

### 理论贡献
- 系统化的攻击分析框架
- 完整的数学推导过程
- 跨领域的安全威胁分析

### 实践意义
- 密码学实现的安全指导
- 系统设计的风险评估
- 安全防护的技术参考

### 教育作用
- 密码学安全的实践教学
- 攻击防护的案例研究
- 安全意识的提升培养

## 法律声明

**重要声明**: 本项目中的所有攻击代码和技术仅用于：
- **教育目的**: 帮助理解密码学安全原理
- **研究用途**: 学术研究和安全分析
- **防护开发**: 开发和测试安全防护措施

**严禁用于**:
- 任何形式的非法攻击
- 未经授权的系统测试
- 恶意的破坏活动

使用者应当：
- 遵守当地法律法规
- 获得适当的授权
- 承担相应的法律责任

## 技术支持

如有问题或建议，请：
1. 查阅相关文档
2. 检查代码实现
3. 联系项目维护者

---

**免责声明**: 本项目仅供学术研究和教育使用。作者不对任何滥用行为承担责任。
